@model TechBoard.ViewModels.Company.Membership.CompanyMembershipViewModel

@{
    ViewData["Title"] = "Membership Management";
    Layout = "_Layout";
}

<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Membership Management</h1>
</div>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success" role="alert">
        @TempData["SuccessMessage"]
    </div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger" role="alert">
        @TempData["ErrorMessage"]
    </div>
}

<div class="row">
    <div class="col-lg-12">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Your current membership</h6>
            </div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-sm-4">Tier name</dt>
                    <dd class="col-sm-8">@Model.CurrentTierName</dd>

                    <dt class="col-sm-4">Price</dt>
                    <dd class="col-sm-8">@(Model.CurrentTierPrice == 0 ? "Free" : $"{Model.CurrentTierPrice:C}")</dd>

                    <dt class="col-sm-4">Max job posts</dt>
                    <dd class="col-sm-8">@(Model.CurrentTierMaxJobPosts == -1 ? "Unlimited" : Model.CurrentTierMaxJobPosts.ToString())</dd>

                    <dt class="col-sm-4">Job post duration</dt>
                    <dd class="col-sm-8">@(Model.CurrentTierJobPostDurationDays == -1 ? "Unlimited" : $"{Model.CurrentTierJobPostDurationDays} days")</dd>
                    
                    <dt class="col-sm-4">Max applications per Job</dt>
                    <dd class="col-sm-8">@(Model.CurrentTierMaxApplicationsPerJob == -1 ? "Unlimited" : Model.CurrentTierMaxApplicationsPerJob.ToString())</dd>

                    <dt class="col-sm-4">Featured job posts</dt>
                    <dd class="col-sm-8">@(Model.CurrentTierCanPostFeatured ? "Yes" : "No")</dd>

                    <dt class="col-sm-4">Access to analytics</dt>
                    <dd class="col-sm-8">@(Model.CurrentTierCanAccessAnalytics ? "Yes" : "No")</dd>
                </dl>
            </div>
        </div>
    </div>
</div>

<hr />

<div class="row">
    <div class="col-lg-12">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Available membership tiers</h6>
            </div>
            <div class="card-body">
                <div class="row">
                    @foreach (var tier in Model.AvailableTiers.OrderBy(t => t.Price))
                    {
                        <div class="col-md-4 mb-4">
                            <div class="card h-100 @(tier.Id == Model.CurrentTierId ? "border-success" : "border-info")">
                                <div class="card-header text-center">
                                    <h4 class="my-0 font-weight-normal">@tier.Name</h4>
                                </div>
                                <div class="card-body">
                                    <h1 class="card-title pricing-card-title">@(tier.Price == 0 ? "Free" : $"{tier.Price:C}") <small class="text-muted">/ mo</small></h1>
                                    <ul class="list-unstyled mt-3 mb-4">
                                        <li>@tier.Description</li>
                                        <li>Max Job Posts: @(tier.MaxJobPosts == -1 ? "Unlimited" : tier.MaxJobPosts.ToString())</li>
                                        <li>Job Post Duration: @(tier.JobPostDurationDays == -1 ? "Unlimited" : $"{tier.JobPostDurationDays} days")</li>
                                        <li>Max Applications: @(tier.MaxApplicationsPerJob == -1 ? "Unlimited" : tier.MaxApplicationsPerJob.ToString())</li>
                                        <li>Featured Posts: @(tier.CanPostFeatured ? "Yes" : "No")</li>
                                        <li>Access Analytics: @(tier.CanAccessAnalytics ? "Yes" : "No")</li>
                                    </ul>
                                    @if (tier.Id == Model.CurrentTierId)
                                    {
                                        <button type="button" class="btn btn-lg btn-block btn-success" disabled>Current Plan</button>
                                    }
                                    else
                                    {
                                        <form asp-action="UpgradeMembership" asp-controller="CompanyMembership" asp-route-tierId="@tier.Id" method="post">
                                            @Html.AntiForgeryToken()
                                            <button type="submit" class="btn btn-lg btn-block btn-outline-primary">Upgrade to @tier.Name</button>
                                        </form>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>